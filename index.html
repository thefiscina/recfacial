<html>

<head>
    <title>Rec Face</title>
    <style>
        video,
        canvas {
            position: absolute;
            border: 1px solid red;
        }
    </style>
</head>

<body>
    <video id="video" width="520" height="440" preload autoplay loop muted> </video>
    <canvas id="canvas" width="520" height="440"></canvas>
    <canvas id="canvas2" width="520" height="440"></canvas>

    <script src="tracking-min.js"></script>
    <script src="node_modules/dat.gui/build/dat.gui.min.js"></script>
    <script src="data/face-min.js"></script>
    <script src="data/eye.js"></script>
    <script src="data/mouth-min.js"></script>
    <script src="assets/stats.min.js"></script>
    <script src="assets/color_camera_gui.js"></script>
    <script>
        function init() {
            const video = document.getElementById('video');
            const canvas = document.getElementById('canvas2');
            const context = canvas.getContext('2d');            
            var person = new tracking.ObjectTracker(['face', 'eye', 'mouth']);
            person.setInitialScale(4);
            person.setStepSize(2);
            person.setEdgesDensity(0.1);
            tracking.track('#video', person, { camera: true });
            person.on('track', function (event) {
                console.log(event);
                context.clearRect(0, 0, canvas.width, canvas.height);
                if (event.data.length === 0) {
                    // No person were detected in this frame.
                } else {
                    event.data.forEach(function (rect) {                       
                        context.strokeStyle = '#18d638';
                        context.lineWidth = 2;
                        context.font = '11px Helvetica';
                        context.fillStyle = "#fff";
                        context.strokeRect(rect.x, rect.y, rect.width, rect.height);
                        context.fillText(`x: ${rect.x}, W: ${rect.width}`, rect.x + rect.width + 20, rect.y + 20);
                        context.fillText(`y: ${rect.x}, H: ${rect.height}`, rect.x + rect.width + 20, rect.y + 40);
                        // rect.x, rect.y, rect.height, rect.width
                    });
                }
            });        
        }
        //window.onload = init();
    </script> 
    <script>
        window.onload = function () {
            init();
            var video = document.getElementById('video');
            var canvas = document.getElementById('canvas');
            var context = canvas.getContext('2d');
            var tracker = new tracking.ColorTracker();
            tracking.track('#video', tracker, { camera: true });
            tracker.on('track', function (event) {
                context.clearRect(0, 0, canvas.width, canvas.height);
                event.data.forEach(function (rect) {
                    if (rect.color === 'custom') {
                        rect.color = tracker.customColor;
                    }
                    context.strokeStyle = rect.color;
                    context.strokeRect(rect.x, rect.y, rect.width, rect.height);
                    context.font = '11px Helvetica';
                    context.fillStyle = "#fff";
                    context.fillText('x: ' + rect.x + 'px', rect.x + rect.width + 5, rect.y + 11);
                    context.fillText('y: ' + rect.y + 'px', rect.x + rect.width + 5, rect.y + 22);
                });
            });
            initGUIControllers(tracker);
        };
    </script>
</body>

</html>